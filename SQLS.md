## CAT_TERRENOS

SELECT [ID_TERRENO]
,[NO_TERRENO]
,[SUPERFICIE]
,[PRECIO_M2]
,isnull([SOBREPRECIO],0) as [SOBREPRECIO]
,[TOTAL_TERRENO]
,isnull([DEPOSITO],0) as [DEPOSITO]
,[PRECIO_FIANCIAR]
,isnull([CALLE],'') as [CALLE]
,isnull([COLINDANCIA1],'') as [COLINDANCIA1]
,isnull([COLINDANCIA2],'') as [COLINDANCIA2]
,isnull([COLINDANCIA3],'') as [COLINDANCIA3]
,isnull([COLINDANCIA4],'') as [COLINDANCIA4]
,[TIPO_TERRENO]
,[ESTATUS]
,isnull(REPLACE([OBSERVACIONES], CHAR(13) + CHAR(10), ' '),'') as [OBSERVACIONES]
,[BND_ACTIVO]
,[ID_MANZANA]
FROM [Lotificadora].[dbo].[CAT_TERRENOS]

## CLIENTES

SELECT
c.[ID_CLIENTE]
,isnull(c.[ABREVIATURA],'SR.') as [ABREVIATURA]
,c.[NOMBRE]
,isnull(c.[AP_PATERNO],'') as [AP_PATERNO]
,isnull(c.[AP_MATERNO],'') as [AP_MATERNO]
,isnull(c.[FECHA_NACIMIENTO],'1900-01-01 00:00:00') as [FECHA_NACIMIENTO]
,isnull(c.[SEXO],'') as [SEXO]
,isnull(c.[LUGAR_NACIMIENTO],'') as [LUGAR_NACIMIENTO]
,isnull(c.[OCUPACION],'') as [OCUPACION]
,isnull(c.[CALLE],'') as [CALLE]
,isnull(c.[NUMERO],'') as [NUMERO]
,isnull(c.[ENTRE],'') as [ENTRE]
,isnull(c.[CIUDAD],'') as [CIUDAD]
,isnull(c.[CP],'0') as [CP]
,isnull(c.[COLONIA],'') as [COLONIA]
,isnull(c.[ESTADO],'') as [ESTADO]
,isnull(c.[PAIS],'') as [PAIS]
,isnull(c.[TEL_CASA],'') as [TEL_CASA]
,isnull(c.[TEL_CEL],'') as [TEL_CEL]
,isnull(c.[TEL_TRABAJO],'') as [TEL_TRABAJO]
,isnull(c.[EMAIL],'') as [EMAIL]
,isnull(c.[LUGAR_TRABAJO],'') as [LUGAR_TRABAJO]
,isnull(c.[DOMICILIO_TRABAJO],'') as [DOMICILIO_TRABAJO]
,isnull(c.[CONYUGE],'') as [CONYUGE]
,isnull(c.[ESTADO_CIVIL],'5') as [ESTADO_CIVIL]
,isnull(c.[NACIONALIDAD],'') as [NACIONALIDAD]
,isnull(c.[FECHA_ALTA],'1900-01-01 00:00:00') as [FECHA_ALTA]
,isnull(c.[TEL_COD_CASA],'') as [TEL_COD_CASA]
,isnull(c.[TEL_COD_CEL],'') as [TEL_COD_CEL]
,isnull(c.[TEL_COD_TRABAJO],'') as [TEL_COD_TRABAJO]
,COALESCE(u.id_usuario, 1) AS ID_USUARIO
--,c.[ID_USUARIO]
,isnull(c.[BND_ACTIVO],'') as [BND_ACTIVO]
,isnull(c.[ULTIMA_MODIFICACION],'1900-01-01 00:00:00') as [ULTIMA_MODIFICACION]
,isnull(c.[ID_ESTATUS_PROSPECTO],'') as [ID_ESTATUS_PROSPECTO]
,isnull(c.[BND_INTERESADO_PROSPECTO],'') as [BND_INTERESADO_PROSPECTO]
,isnull(c.[ID_MEDIO_PUBLICITARIO],'44') as [ID_MEDIO_PUBLICITARIO]
,isnull(c.[TEL_USA_CEL],'') as [TEL_USA_CEL]
,isnull(c.[TEL_USA_CASA],'') as [TEL_USA_CASA]
,isnull(c.[TEL_USA_OFICINA],'') as [TEL_USA_OFICINA]
,isnull(c.[NOTAS],'') as [NOTAS]
,isnull(c.[FECHA_CORREO],'1900-01-01 00:00:00') as [FECHA_CORREO]
--,isnull(c.[ASESOR_COBRANZA],'') as
,COALESCE(z.id_usuario, 1) AS ASESOR_COBRANZA
--COALESCE(u.id_usuario, 1) AS ID_USUARIO
--u.USUARIO
FROM
clientes c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ID_USUARIO = u.usuario

LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.ASESOR_COBRANZA = z.usuario

## CONTRATOS_TERRENOS

SELECT [ID_CONTRATO]
,[ID_TERRENO]
,[ID_ESTATUS_CONTRATO]
,[ID_CLIENTE]
--,isnull([FECHA_CONTRATO],'1900-01-01 00:00:00') as [FECHA_CONTRATO]
,[FECHA_CONTRATO]
,[BND_ACTIVO]
,[FECHA_FIRMA]
,[BLOQUEO_CAJA]
,[BND_CANCELADO]
,COALESCE(u.id_usuario, NULL) AS [VENDEDOR]
--,VENDEDOR
,COALESCE(z.id_usuario, NULL) AS [VENDEDOR_COMPARTIDO]
--,VENDEDOR_COMPARTIDO
,[ID_CAUSA_CANCELACION]
,REPLACE([COMENTARIOS_CANCELACION], CHAR(13), ' ') AS [COMENTARIOS_CANCELACION]
,[ID_ESTATUS_VENTAS]
,[FECHA_CANCELACION]
,[ID_MEDIO_PUBLICITARIO]
,[BND_CONTRATO_ENTREGADO]
,[BND_DESCUENTOS]
,COALESCE(w.id_usuario, NULL) AS [ID_USUARIO_CANCELACION]
,REPLACE([NOTA], CHAR(13), ' ') AS NOTA
FROM [Lotificadora].[dbo].[CONTRATOS_TERRENOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.VENDEDOR = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.VENDEDOR_COMPARTIDO = z.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
w ON c.ID_USUARIO_CANCELACION = w.usuario

## COBRANZA_CARTAS_DEVOLUCION

SELECT [ID_CONTRATO]
,[MONTO_DEVOLUCION]
,[FECHA_CARTA]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
-- ,c.ID_USUARIO
,[MONTO_CARGO]
,[NO_PAGOS]
,[PORCENTAJE_CARGO_CANCELACION]
,REPLACE([NOTAS1], CHAR(13), ' ') AS [NOTAS1]
,REPLACE([NOTAS2], CHAR(13), ' ') AS [NOTAS2]
,ROW_NUMBER() OVER(ORDER BY ID_CONTRATO) as ID_ROW
FROM [Lotificadora].[dbo].[COBRANZA_CARTAS_DEVOLUCION] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ID_USUARIO = u.usuario

## COBRANZA_COMPROMISOS_PAGO

SELECT [ID_COMPROMISO]
,[ID_CONTRATO]
,[FECHA_COMPROMISO]
,[MONTO]
,[BND_PAGADO]
,[FECHA_PAGO]
,[NO_RECIBO]
,[BND_ACTIVO]
,REPLACE([COMENTARIOS], CHAR(13), ' ') AS [COMENTARIOS]
,[FECHA_MOVIMIENTO]
FROM [Lotificadora].[dbo].[COBRANZA_COMPROMISOS_PAGO]

## COMENTARIOS_CAJA

SELECT [ID_COMENTARIO]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[FECHA_COMENTARIO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
-- ,c.ID_USUARIO
,[ID_CONTRATO]
FROM [Lotificadora].[dbo].[COMENTARIOS_CAJA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ID_USUARIO = u.usuario

## COMISIONES

SELECT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_COMISION
,[ID_CONTRATO]
,[NO_COMISION]
,[PERIODO]
,[BND_ACTIVO]
,[BND_PAGADO_PRIMARIO]
,[BND_PAGADO_SECUNDARIO]
,COALESCE(u.id_usuario, NULL) AS [ASESOR_PRIMARIO]
-- ,ASESOR_PRIMARIO
,COALESCE(z.id_usuario, NULL) AS [ASESOR_SECUNDARIO]
-- ,ASESOR_SECUNDARIO
,[MONTO_PRIMARIO]
,[MONTO_SECUNDARIO]
,[FECHA_PAGO_PRIMARIO]
,[FECHA_PAGO_SECUNDARIO]
,[BND_BLOQUEO]
--,[MONTO_ORIGINAL] -- ESTA COLUMNA SE MUEVE AL FINAL POR QUE EN POSTGRESQL OLVIDE CREARLA Y SE AGREGO AL FINAL DE LA TABLA
,[BND_MENSUALIDAD_PAGADA]
,[BND_CONTRATO_FIRMADO]
,[MONTO_PAGADO_PRIMARIO]
,[MONTO_PAGADO_SECUNDARIO]
,[MONTO_ORIGINAL]
-- ,[isnull_bnd_bloqueo_0]
FROM [Lotificadora].[dbo].[COMISIONES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ASESOR_PRIMARIO = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.ASESOR_SECUNDARIO = z.usuario

## COMISIONES_PAGOS

SELECT [ID_PAGO]
,[ID_CONTRATO]
,[NO_COMISION]
,[MONTO]
,COALESCE(u.id_usuario, NULL) AS [ASESOR]
--,[ASESOR]
,[FECHA_PAGO]
FROM [Lotificadora].[dbo].[COMISIONES_PAGOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ASESOR = u.usuario

## CONSUMO_AGUA_CARGA

SELECT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS [ID_CARGA]
--,ID_CARGA
,[FECHA_CARGA]
,[ID_CONTRATO]
,[NO_MEDIDOR]
,[LECTURA_ANTERIOR]
,[LECTURA_ACTUAL]
,[FECHA_LECTURA]
,[OBSERVACIONES]
,[PERIODO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
--,c.USUARIO
,[ID_SERVICIO]
,[CONSUMO_M3]
,[CONSUMO_MONTO]
FROM [Lotificadora].[dbo].[CONSUMO_AGUA_CARGA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[USUARIO] = u.usuario

## CONSUMO_AGUA_LECTURAS

SELECT [id_carga]
,[id_toma]
,[lectura]
,[fecha_lectura]
,[observaciones]
,[fotos]
,[importe]
,COALESCE(u.id_usuario, NULL) AS [usuario_carga]
--,[usuario_autoriza]
--,[carga_autorizada]
--,[fecha_autorizacion]
,[periodo_lectura]
,[periodo_lectura_anio]
,[estatus_lectura]
,[id_movimiento_detalle]
FROM [Lotificadora].[dbo].[CONSUMO_AGUA_LECTURAS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[usuario_carga] = u.usuario

## COPROPIETARIOS

SELECT [ID_COPROPIETARIO]
,[ABREVIATURA]
,[NOMBRE]
,[AP_PATERNO]
,[AP_MATERNO]
,[FECHA_NACIMIENTO]
--,[SEXO] --se mueve esta columna al final por que olvide crear este campo en la BD de postgressql
,[LUGAR_NACIMIENTO]
,[OCUPACION]
,[CALLE]
,[NUMERO]
,[CIUDAD]
,[CP]
,[COLONIA]
,[ESTADO]
,[PAIS]
,[TEL_CASA]
,[TEL_CEL]
,[TEL_TRABAJO]
,[EMAIL]
,[LUGAR_TRABAJO]
,[DOMICILIO_TRABAJO]
,[CONYUGE]
,[ESTADO_CIVIL]
,[NACIONALIDAD]
,[FECHA_ALTA]
,[TEL_COD_CASA]
,[TEL_COD_CEL]
,[TEL_COD_TRABAJO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[BND_PRINCIPAL]
,[BND_ACTIVO]
,[BND_PERMISO]
,[BND_MANUAL]
,[BND_COPIA_CONTRATO]
,[BND_CONEXION_ELECTRICA]
,[BND_TOMA_AGUA]
,[BND_BIODIGESTOR]
,[ID_CLIENTE]
,[ID_TERRENO]
,[ID_CONTRATO]
,[SEXO]
FROM [Lotificadora].[dbo].[COPROPIETARIOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ID_USUARIO = u.usuario

## LISTA_PRECIOS

SELECT [idFraccionamiento]
,[idTipoTerreno]
,[precioM2]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[LISTA_PRECIOS]

## MOVIMIENTOS_DETALLE PARTE 1

SELECT [ID_MOVIMIENTO_DETALLE]
,[ID_MOVIMIENTO_CABECERA]
,[NO_PAGO]
,[ID_TIPO_MOVIMIENTO]
,[MONTO]
,[FECHA_MOVIMIENTO]
,[BND_ACTIVO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
--,c.USUARIO
,[ID_CONTRATO]
,[BND_PAGADO]
,[NO_RECIBO]
,[MONTO_SALDO]
,[DESCUENTO_TIPO]
,[DIAS_INTERES_PAGADOS]
,REPLACE([JUSTIFICACION_DESCUENTO], CHAR(13), ' ') AS [JUSTIFICACION_DESCUENTO]
,[ID_TIPO_PAGO]
,REPLACE([REFERENCIA], CHAR(13), ' ') AS [REFERENCIA]
,[ID_ULT_AJUSTE_ANUAL]
,[SALDO_RECIBO]
,[ID_SERVICIO]
,[TIPO_CAMBIO]
,[DESCUENTO_MENSUALIDAD]
,[DESCUENTO_INTERES]
,[MONTO_EFECTIVO]
,[MONTO_CHEQUE]
,[MONTO_DLLS]
,[ID_CARGA]
,[NO_MEDIDOR]
,[ID_POLIZA]
,[IMPRESION]
,REPLACE([JUSTIFICACION_CANCELACION_RECIBO], CHAR(13), ' ') AS [JUSTIFICACION_CANCELACION_RECIBO]
,REPLACE([JUSTIFICACION_NOTA], CHAR(13), ' ') AS [JUSTIFICACION_NOTA]
,(SELECT 0) AS BND_CONTRATO_CANCELADO
FROM [Lotificadora].[dbo].[MOVIMIENTOS_DETALLE] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario
ORDER BY ID_MOVIMIENTO_DETALLE ASC
OFFSET 0 ROWS
FETCH NEXT 500000 ROWS ONLY;

## MOVIMIENTOS_DETALLE PARTE 2

SELECT [ID_MOVIMIENTO_DETALLE]
,[ID_MOVIMIENTO_CABECERA]
,[NO_PAGO]
,[ID_TIPO_MOVIMIENTO]
,[MONTO]
,[FECHA_MOVIMIENTO]
,[BND_ACTIVO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
--,c.USUARIO
,[ID_CONTRATO]
,[BND_PAGADO]
,[NO_RECIBO]
,[MONTO_SALDO]
,[DESCUENTO_TIPO]
,[DIAS_INTERES_PAGADOS]
,REPLACE([JUSTIFICACION_DESCUENTO], CHAR(13), ' ') AS [JUSTIFICACION_DESCUENTO]
,[ID_TIPO_PAGO]
,REPLACE([REFERENCIA], CHAR(13), ' ') AS [REFERENCIA]
,[ID_ULT_AJUSTE_ANUAL]
,[SALDO_RECIBO]
,[ID_SERVICIO]
,[TIPO_CAMBIO]
,[DESCUENTO_MENSUALIDAD]
,[DESCUENTO_INTERES]
,[MONTO_EFECTIVO]
,[MONTO_CHEQUE]
,[MONTO_DLLS]
,[ID_CARGA]
,[NO_MEDIDOR]
,[ID_POLIZA]
,[IMPRESION]
,REPLACE([JUSTIFICACION_CANCELACION_RECIBO], CHAR(13), ' ') AS [JUSTIFICACION_CANCELACION_RECIBO]
,REPLACE([JUSTIFICACION_NOTA], CHAR(13), ' ') AS [JUSTIFICACION_NOTA]
,(SELECT 0) AS BND_CONTRATO_CANCELADO
FROM [Lotificadora].[dbo].[MOVIMIENTOS_DETALLE] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario
ORDER BY ID_MOVIMIENTO_DETALLE ASC
OFFSET 500000 ROWS
FETCH NEXT 500000 ROWS ONLY;

## MOVIMIENTOS_DETALLE PARTE 3

SELECT [ID_MOVIMIENTO_DETALLE]
,[ID_MOVIMIENTO_CABECERA]
,[NO_PAGO]
,[ID_TIPO_MOVIMIENTO]
,[MONTO]
,[FECHA_MOVIMIENTO]
,[BND_ACTIVO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
--,c.USUARIO
,[ID_CONTRATO]
,[BND_PAGADO]
,[NO_RECIBO]
,[MONTO_SALDO]
,[DESCUENTO_TIPO]
,[DIAS_INTERES_PAGADOS]
,REPLACE([JUSTIFICACION_DESCUENTO], CHAR(13), ' ') AS [JUSTIFICACION_DESCUENTO]
,[ID_TIPO_PAGO]
,REPLACE([REFERENCIA], CHAR(13), ' ') AS [REFERENCIA]
,[ID_ULT_AJUSTE_ANUAL]
,[SALDO_RECIBO]
,[ID_SERVICIO]
,[TIPO_CAMBIO]
,[DESCUENTO_MENSUALIDAD]
,[DESCUENTO_INTERES]
,[MONTO_EFECTIVO]
,[MONTO_CHEQUE]
,[MONTO_DLLS]
,[ID_CARGA]
,[NO_MEDIDOR]
,[ID_POLIZA]
,[IMPRESION]
,REPLACE([JUSTIFICACION_CANCELACION_RECIBO], CHAR(13), ' ') AS [JUSTIFICACION_CANCELACION_RECIBO]
,REPLACE([JUSTIFICACION_NOTA], CHAR(13), ' ') AS [JUSTIFICACION_NOTA]
,(SELECT 0) AS BND_CONTRATO_CANCELADO
FROM [Lotificadora].[dbo].[MOVIMIENTOS_DETALLE] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario
ORDER BY ID_MOVIMIENTO_DETALLE ASC
OFFSET 1000000 ROWS
FETCH NEXT 500000 ROWS ONLY;

## MOVIMIENTOS_DETALLE PARTE 4

SELECT [ID_MOVIMIENTO_DETALLE]
,[ID_MOVIMIENTO_CABECERA]
,[NO_PAGO]
,[ID_TIPO_MOVIMIENTO]
,[MONTO]
,[FECHA_MOVIMIENTO]
,[BND_ACTIVO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
--,c.USUARIO
,[ID_CONTRATO]
,[BND_PAGADO]
,[NO_RECIBO]
,[MONTO_SALDO]
,[DESCUENTO_TIPO]
,[DIAS_INTERES_PAGADOS]
,REPLACE([JUSTIFICACION_DESCUENTO], CHAR(13), ' ') AS [JUSTIFICACION_DESCUENTO]
,[ID_TIPO_PAGO]
,REPLACE([REFERENCIA], CHAR(13), ' ') AS [REFERENCIA]
,[ID_ULT_AJUSTE_ANUAL]
,[SALDO_RECIBO]
,[ID_SERVICIO]
,[TIPO_CAMBIO]
,[DESCUENTO_MENSUALIDAD]
,[DESCUENTO_INTERES]
,[MONTO_EFECTIVO]
,[MONTO_CHEQUE]
,[MONTO_DLLS]
,[ID_CARGA]
,[NO_MEDIDOR]
,[ID_POLIZA]
,[IMPRESION]
,REPLACE([JUSTIFICACION_CANCELACION_RECIBO], CHAR(13), ' ') AS [JUSTIFICACION_CANCELACION_RECIBO]
,REPLACE([JUSTIFICACION_NOTA], CHAR(13), ' ') AS [JUSTIFICACION_NOTA]
,(SELECT 0) AS BND_CONTRATO_CANCELADO
FROM [Lotificadora].[dbo].[MOVIMIENTOS_DETALLE] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario
ORDER BY ID_MOVIMIENTO_DETALLE ASC
OFFSET 1500000 ROWS;

## MOVIMIENTOS_DETALLE_CANCELADOS

SELECT [ID_MOVIMIENTO_DETALLE]
,[ID_MOVIMIENTO_CABECERA]
,[NO_PAGO]
,[ID_TIPO_MOVIMIENTO]
,[MONTO]
,[FECHA_MOVIMIENTO]
,[BND_ACTIVO]
,COALESCE(u.id_usuario, NULL) AS [USUARIO]
,[ID_CONTRATO]
,[BND_PAGADO]
,[NO_RECIBO]
,[MONTO_SALDO]
,[DESCUENTO_TIPO]
,[DIAS_INTERES_PAGADOS]
,REPLACE([JUSTIFICACION_DESCUENTO], CHAR(13), ' ') AS [JUSTIFICACION_DESCUENTO]
,[ID_TIPO_PAGO]
,REPLACE([REFERENCIA], CHAR(13), ' ') AS [REFERENCIA]
,[ID_ULT_AJUSTE_ANUAL]
,[SALDO_RECIBO]
,[ID_SERVICIO]
,[TIPO_CAMBIO]
,[DESCUENTO_MENSUALIDAD]
,[DESCUENTO_INTERES]
,[MONTO_EFECTIVO]
,[MONTO_CHEQUE]
,[MONTO_DLLS]
,[ID_CARGA]
,[NO_MEDIDOR]
,[ID_POLIZA]
,[IMPRESION]
,REPLACE([JUSTIFICACION_CANCELACION_RECIBO], CHAR(13), ' ') AS [JUSTIFICACION_CANCELACION_RECIBO]
,REPLACE([JUSTIFICACION_NOTA], CHAR(13), ' ') AS [JUSTIFICACION_NOTA]
,(SELECT 1) AS BND_CONTRATO_CANCELADO
FROM [Lotificadora].[dbo].[MOVIMIENTOS_DETALLE_CANCELADOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario

## REFERENCIAS_PERSONALES

SELECT [ID_REFERENCIA]
,[ABREVIATURA]
,[NOMBRE]
,[AP_PATERNO]
,[AP_MATERNO]
,[PARENTESCO]
,[CALLE]
,[NUMERO]
,[ENTRE]
,[CIUDAD]
,[CP]
,[COLONIA]
,[ESTADO]
,[PAIS]
,[TEL_CASA]
,[TEL_CEL]
,[TEL_TRABAJO]
,[FECHA_ALTA]
,[TEL_COD_CASA]
,[TEL_COD_CEL]
,[TEL_COD_TRABAJO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,REPLACE([OBSERVACIONES], CHAR(13), ' ') AS [OBSERVACIONES]
,[ID_TERRENO]
,[ID_CONTRATO]
FROM [Lotificadora].[dbo].[REFERENCIAS_PERSONALES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario

## REFERENCIAS_PERSONALES

SELECT [ID_REFERENCIA]
,[ABREVIATURA]
,REPLACE([NOMBRE], ',', ' ') AS [NOMBRE]
,[AP_PATERNO]
,[AP_MATERNO]
,[PARENTESCO]
,REPLACE(REPLACE(REPLACE([CALLE], '"', ''), '''', ''), '-', '-') AS [CALLE]
,[NUMERO]
,[ENTRE]
,[CIUDAD]
,[CP]
,[COLONIA]
,[ESTADO]
,[PAIS]
,[TEL_CASA]
,[TEL_CEL]
,[TEL_TRABAJO]
,[FECHA_ALTA]
,[TEL_COD_CASA]
,[TEL_COD_CEL]
,[TEL_COD_TRABAJO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,REPLACE([OBSERVACIONES], CHAR(13), ' ') AS [OBSERVACIONES]
,[ID_TERRENO]
,[ID_CONTRATO]
FROM [Lotificadora].[dbo].[REFERENCIAS_PERSONALES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario

## REUBICACIONES

SELECT [ID_REUBICACION]
,[FECHA_MOVIMIENTO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[ID_CONTRATO_ANTERIOR]
,[ID_CONTRATO_NUEVO]
,[COMISION_PORCENTAJE]
,[COMISION_MONTO]
,REPLACE([COMENTARIOS], CHAR(13), ' ') AS [COMENTARIOS]
,[SALDO_PENDIENTE]
,[PAGO_INICIAL]
,[NO_PAGOS_PENDIENTES]
FROM [Lotificadora].[dbo].[REUBICACIONES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.ID_USUARIO = u.usuario

## SERVICIOS_FRACCIONAMIENTO

SELECT [ID_SERVICIO]
,[ID_FRACCIONAMIENTO]
,[MONTO_INICIAL]
,[CUENTA]
,[TIPO_CUENTA]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[SERVICIOS_FRACCIONAMIENTO]

## SERVICIOS_INFORMATIVOS_TERRENOS

SELECT [ID_SERVICIO]
,[ID_TERRENO]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[SERVICIOS_INFORMATIVOS_TERRENOS]

## ServiciosPopUp

SELECT [idSolicitud]
,[idServicio]
,[idContrato]
,COALESCE(u.id_usuario, NULL) AS [usuario]
--,c.usuario
,[fechaSolicitud]
,[fechaEntrega]
,[fechaEntregaCliente]
,COALESCE(z.id_usuario, NULL) AS [usuarioEntrega]
-- ,c.usuarioEntrega
FROM [Lotificadora].[dbo].[ServiciosPopUp] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.USUARIO = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.usuarioEntrega = z.usuario

## SISTEMA_TRASPASOS

SELECT [ID_TRASPASO]
,[CLIENTE_ANTERIOR]
,[ID_FRACCIONAMIENTO]
,[ID_MANZANA]
,[ID_TERRENO]
,[FECHA_CONTRATO]
,[NOMBRE_CLIENTE_NUEVO]
,[MEDIO_DE_ENTREGA]
,[FECHA1]
,[OBSERVACIONES]
,[FECHA2]
,[FECHA3]
,[FECHA4]
,[FECHA5]
,[FECHA6]
,[FECHA7]
,[FECHA8]
,[FECHA9]
,[FECHA10]
,[FECHA11]
,[FECHA12]
,[FECHA13]
,[FECHA14]
,[TRASPASADO]
,[PRECIO_TERRENO]
,[MONTO_CARGO]
,[FOLIO]
,[CANCELADO]
FROM [Lotificadora].[dbo].[SISTEMA_TRASPASOS]
order by ID_TRASPASO

## SISTEMA_TRASPASOS_FOLIOS

SELECT TOP (1000) [empresa1]
,[empresa2]
,[empresa3]
,[empresa4]
,[empresa5]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[SISTEMA_TRASPASOS_FOLIOS]

## SISTEMA_TRASPASOS_RECIBOS

SELECT [id]
,[id_Traspaso]
,[Folio]
,[ClienteAnterior]
,[ClienteNuevo]
,[idFraccionamiento]
,[idManzana]
,[idTerreno]
,[fechaContrato]
,[precioTerreno]
,[montoCargo]
,[Cancelado]
,[fechaRecibo]
,COALESCE(u.id_usuario, NULL) AS [cajero]
--,c.cajero
FROM [Lotificadora].[dbo].[SISTEMA_TRASPASOS_RECIBOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[cajero] = u.usuario
order by id asc

## TRASPASOS

SELECT [ID_TRASPASO]
,[FECHA]
,[ID_CLIENTE_NUEVO]
,[ID_CLIENTE_ANTERIOR]
,[COMISION]
,[ID_CONTRATO]
,[MONTO_COMISION]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.[ID_USUARIO]
,REPLACE([COMENTARIOS], CHAR(13), ' ') AS [COMENTARIOS]
,[FOLIO_RECIBO]
FROM [Lotificadora].[dbo].[TRASPASOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario

## ADMIN_CIERRE_PERIODO_CABECERA

SELECT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_CABECERA
,[ANIO]
,[MES]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
,[FECHA]
FROM [Lotificadora].[dbo].[ADMIN_CIERRE_PERIODO_CABECERA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
ORDER BY ANIO ASC,MES ASC, C.FECHA ASC

## ADMIN_CIERRE_PERIODO_DETALLE

SELECT ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_DETALLE
,[ANIO]
,[MES]
,[ID_FRACCIONAMIENTO]
,[TOTAL_TERRENOS]
,[POST_VENTA]
,[ACTIVOS]
,[DISPONIBLES]
,[DONACIONES]
,[BLOQUEADOS]
,[TOTAL_CONTRATADO]
,[DEPOSITO]
,[DEPOSITO_NC]
,[MENSUALIDAD]
,[MENSUALIDAD_NC]
,[DESCUENTOS]
,[TOTAL_PAGADO]
,[TOTAL_PAGADO_NC]
,[SALDO]
,[CLIENTES_VENCIDOS_1_MES]
,[CLIENTES_VENCIDOS_2_MES]
,[CLIENTES_VENCIDOS_3_MES]
,[CLIENTES_VENCIDOS_4_MES]
,[MONTO_VENCIDO_1_MES]
,[MONTO_VENCIDO_2_MES]
,[MONTO_VENCIDO_3_MES]
,[MONTO_VENCIDO_4_MES]
,[TOTAL_SERVICIOS]
,[TOTAL_SERVICIOS_NC]
,[TOTAL_INTERESES]
,[TOTAL_INTERESES_NC]
FROM [Lotificadora].[dbo].[ADMIN_CIERRE_PERIODO_DETALLE]
ORDER BY ANIO ASC, MES ASC, ID_FRACCIONAMIENTO ASC

## AGENDA

SELECT [ID_AGENDA]
,[ID_CLIENTE]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,C.[ID_USUARIO]
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,COALESCE(Z.id_usuario, NULL) AS [ID_USUARIO_COMENTARIO]
-- ,C.ID_USUARIO_COMENTARIO
,(SELECT 1) AS ESTATUS_AGENDA
FROM [Lotificadora].[dbo].[AGENDA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_COMENTARIO] = z.usuario

ORDER BY C.ID_AGENDA ASC

## AGENDA_COBRANZA PARTE 1

-- correr el update antes de exportar esta tabla
--update AGENDA_COBRANZA set ID_USUARIO_ATENDIO = NULL where ID_USUARIO_ATENDIO like '2'

SELECT [ID_AGENDA]
,[ID_CONTRATO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[ID_TIPO_COMENTARIO]
,[BND_MOSTRAR_CAJA]
,[BND_ATENDIDO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_ATENDIO]
--,c.ID_USUARIO_ATENDIO
FROM [Lotificadora].[dbo].[AGENDA_COBRANZA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_ATENDIO] = z.usuario
order by ID_AGENDA asc
OFFSET 0 ROWS
FETCH NEXT 500000 ROWS ONLY;

## AGENDA_COBRANZA PARTE 2

SELECT [ID_AGENDA]
,[ID_CONTRATO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[ID_TIPO_COMENTARIO]
,[BND_MOSTRAR_CAJA]
,[BND_ATENDIDO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_ATENDIO]
--,c.ID_USUARIO_ATENDIO
FROM [Lotificadora].[dbo].[AGENDA_COBRANZA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_ATENDIO] = z.usuario
order by ID_AGENDA asc
OFFSET 500000 ROWS
FETCH NEXT 500000 ROWS ONLY;

## AGENDA_COBRANZA PARTE 3

SELECT [ID_AGENDA]
,[ID_CONTRATO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[ID_TIPO_COMENTARIO]
,[BND_MOSTRAR_CAJA]
,[BND_ATENDIDO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_ATENDIO]
--,c.ID_USUARIO_ATENDIO
FROM [Lotificadora].[dbo].[AGENDA_COBRANZA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_ATENDIO] = z.usuario
order by ID_AGENDA asc
OFFSET 1000000 ROWS
FETCH NEXT 500000 ROWS ONLY;

## AGENDA_COBRANZA PARTE 4

SELECT [ID_AGENDA]
,[ID_CONTRATO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[ID_TIPO_COMENTARIO]
,[BND_MOSTRAR_CAJA]
,[BND_ATENDIDO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_ATENDIO]
--,c.ID_USUARIO_ATENDIO
FROM [Lotificadora].[dbo].[AGENDA_COBRANZA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_ATENDIO] = z.usuario
order by ID_AGENDA asc
OFFSET 1500000 ROWS
FETCH NEXT 500000 ROWS ONLY;

## AGENDA_COBRANZA PARTE 5

SELECT [ID_AGENDA]
,[ID_CONTRATO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[FECHA_ALTA]
,[FECHA_COMPROMISO]
,[ID_CLASIFICACION]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[ID_TIPO_COMENTARIO]
,[BND_MOSTRAR_CAJA]
,[BND_ATENDIDO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_ATENDIO]
--,c.ID_USUARIO_ATENDIO
FROM [Lotificadora].[dbo].[AGENDA_COBRANZA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_ATENDIO] = z.usuario
order by ID_AGENDA asc
OFFSET 2000000 ROWS;

## AGUA_RECONEXIONES

SELECT [id_reconexion]
,[nomenclatura]
,[periodo]
,[fecha_captura]
,COALESCE(u.id_usuario, NULL) AS [usr]
--,c.[usr]
,[estatus]
FROM [Lotificadora].[dbo].[AGUA_RECONEXIONES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[usr] = u.usuario
order by c.id_reconexion asc

## AJUSTE_ANUAL

SELECT [ID_AJUSTE]
,[ID_EMPRESA]
,[ID_FRACCIONAMIENTO]
,[ID_MANZANA]
,[ID_TERRENO]
,[CLIENTE]
,[FECHA_INICIO_CONTRATO]
,[FECHA_FIN_CONTRATO]
,[MES]
,[CANTIDAD]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,C.ID_USUARIO
,[FECHA_AJUSTE]
,[ANIO]
FROM [Lotificadora].[dbo].[AJUSTE_ANUAL] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
ORDER BY C.ID_AJUSTE ASC

## AJUSTE_ANUAL_DETALLE

SELECT [ID_AJUSTE]
,[ID_CONTRATO]
,[SALDO_ANTERIOR]
,[SALDO_ACTUAL]
,[MENSUALIDAD_ANTERIOR]
,[MENSUALIDAD_ACTUAL]
,[MENSUALIDADES_PENDIENTES]
,[FECHA_AJUSTE]
,(SELECT null) as ID_USUARIO
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[AJUSTE_ANUAL_DETALLE]

## ATENCION_A_CLIENTES

SELECT [idSolicitudServicio]
,[idServicio]
,[idContrato]
,COALESCE(u.id_usuario, NULL) AS [Usuario]
--,c.[Usuario]
,[Estado]
,[MedioSolicitud]
,[Transformador]
,[FechaSolicitud]
,[FechaMarcado]
,[FechaCartaListaEntrega]
,[FechaEntregaCliente]
,[FechaCompra]
,[FechaEnvio]
,[FechaCartaRecepcionCliente]
,[FechaInstalacion_1]
,[FechaInstalacion_2]
,[FechaSolicitudPresupuesto]
,[FechaPresupuestoRecibido]
,[FechaRevisionContraloria]
,[FechaPresupuestoAutorizado]
,[FechaEntregaPaquete]
,[FechaPresupuestoConexion]
,[FechaPagoPresupuesto]
,[FechaConexion]
,[FechaSolicitudContrato]
,[FechaInstalacionMedidor]
,[FechaEnvioPresupuesto]
,[MedioEnvioPresupuesto]
,[FechaPagoAnticipo]
,[FechaEnvioContratoCESPM]
,[CuentaCESPM]
,[FechaDescubrimiento]
,[FechaMedidorCESPM]
,[FechaEnvioSolicitudCFE]
,[FolioSeguimientoCFE]
,[FechaMedidorCFE]
FROM [Lotificadora].[dbo].[ATENCION_A_CLIENTES] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[Usuario] = u.usuario
order by idSolicitudServicio asc

## ATENCION_A_CLIENTES_COMENTARIOS

SELECT [id_solicitud]
,COALESCE(u.id_usuario, NULL) AS [usuario]
--,c.[usuario]
,REPLACE([comentario], CHAR(13), ' ') AS [comentario]
,[fecha]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[ATENCION_A_CLIENTES_COMENTARIOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[usuario] = u.usuario
order by id_solicitud asc

## ATENCION_A_CLIENTES_LEVANTAMIENTO_SERVICIOS_COMENTARIOS

SELECT [id_terreno]
,COALESCE(u.id_usuario, NULL) AS [usuario]
--,c.usuario
,[comentario]
,[fecha]
,ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS ID_ROW
FROM [Lotificadora].[dbo].[ATENCION_A_CLIENTES_LEVANTAMIENTO_SERVICIOS_COMENTARIOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[usuario] = u.usuario
order by fecha asc

## BENEFICIARIOS

SELECT [ID_BENEFICIARIO]
,[ABREVIATURA]
,[NOMBRE]
,[AP_PATERNO]
,[AP_MATERNO]
,[FECHA_NACIMIENTO]
,[LUGAR_NACIMIENTO]
,[OCUPACION]
,[CALLE]
,[NUMERO]
,[ENTRE]
,[CIUDAD]
,[CP]
,[COLONIA]
,[ESTADO]
,[PAIS]
,[TEL_CASA]
,[TEL_CEL]
,[TEL_TRABAJO]
,[EMAIL]
,[LUGAR_TRABAJO]
,[CONYUGE]
,[ESTADO_CIVIL]
,[NACIONALIDAD]
,[FECHA_ALTA]
,[TEL_COD_CASA]
,[TEL_COD_CEL]
,[TEL_COD_TRABAJO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
-- ,c.ID_USUARIO
,[ID_TERRENO]
,[ID_CONTRATO]
,[PARENTESCO]
FROM [Lotificadora].[dbo].[BENEFICIARIOS] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
order by ID_BENEFICIARIO asc

## BITACORA

SELECT [ID_BITACORA]
,REPLACE([COMENTARIO], CHAR(13), ' ') AS [COMENTARIO]
,[FECHA_COMENTARIO]
,[ID_TIPO_COMENTARIO]
,COALESCE(u.id_usuario, NULL) AS [ID_USUARIO]
--,c.ID_USUARIO
,[PROSPECTO_NOMBRE]
,[TELEFONO]
,[TURNO]
,[ID_ESTACION]
-- ,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_TURNO]
,c.[ID_USUARIO_TURNO]
,COALESCE(z.id_usuario, NULL) AS [ID_USUARIO_TURNO_ACTUAL]
--,c.[ID_USUARIO_TURNO_ACTUAL]
,[AP_PATERNO]
,[AP_MATERNO]
,[REASIGNADO]
FROM [Lotificadora].[dbo].[BITACORA] c
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
u ON c.[ID_USUARIO] = u.usuario
LEFT JOIN
(select ROW_NUMBER() OVER (ORDER BY USUARIO ASC)+1 as ID_USUARIO, LOWER(USUARIO) as USUARIO from usuarios)
z ON c.[ID_USUARIO_TURNO_ACTUAL] = z.usuario
order by ID_BITACORA asc
